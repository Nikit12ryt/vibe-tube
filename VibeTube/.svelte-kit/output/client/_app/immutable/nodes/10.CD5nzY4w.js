import{c as I,a as f,f as M}from"../chunks/b5zj641C.js";import{i as ia}from"../chunks/CPnGWO-2.js";import{o as la}from"../chunks/Bvetg77p.js";import{f as D,p as na,l as Ne,j as va,t as z,k as ca,o as e,n as m,y as oa,m as i,q as t,r,$ as da,u as s,v as d,Z as ua}from"../chunks/BM2AIrRx.js";import{s as u,e as me}from"../chunks/D17zy_22.js";import{l as fe,s as ge,i as N,a as pa,b as ma}from"../chunks/BLbrYCs1.js";import{h as _a}from"../chunks/DMkD6tIR.js";import{I as he,l as fa,t as ga,s as Be,r as Fe,b as L,c as _e}from"../chunks/C02I7yOd.js";import{H as ha,U as ba}from"../chunks/aIAfHqPP.js";import{S as $a}from"../chunks/BcVKEG13.js";import{s as be}from"../chunks/Doq7kNre.js";function xa(S,$){const w=fe($,["children","$$slots","$$events","$$legacy"]);const A=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5"}],["path",{d:"M10 9H8"}],["path",{d:"M16 13H8"}],["path",{d:"M16 17H8"}]];he(S,ge({name:"file-text"},()=>w,{get iconNode(){return A},children:(U,p)=>{var a=I(),v=D(a);be(v,$,"default",{}),f(U,a)},$$slots:{default:!0}}))}function He(S,$){const w=fe($,["children","$$slots","$$events","$$legacy"]);const A=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}],["circle",{cx:"9",cy:"9",r:"2"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"}]];he(S,ge({name:"image"},()=>w,{get iconNode(){return A},children:(U,p)=>{var a=I(),v=D(a);be(v,$,"default",{}),f(U,a)},$$slots:{default:!0}}))}function wa(S,$){const w=fe($,["children","$$slots","$$events","$$legacy"]);const A=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2"}]];he(S,ge({name:"mail"},()=>w,{get iconNode(){return A},children:(U,p)=>{var a=I(),v=D(a);be(v,$,"default",{}),f(U,a)},$$slots:{default:!0}}))}var ya=M('<div class="loading svelte-1i19ct2"> </div>'),za=M("<div> </div>"),Ma=M('<div class="preview svelte-1i19ct2"><img alt="Avatar preview" class="svelte-1i19ct2"/> <span class="svelte-1i19ct2"> </span></div>'),Sa=M('<div class="preview svelte-1i19ct2"><img alt="Avatar preview" class="svelte-1i19ct2"/> <span class="svelte-1i19ct2"> </span></div>'),Aa=M('<div class="preview banner-preview svelte-1i19ct2"><img alt="Banner preview" class="svelte-1i19ct2"/> <span class="svelte-1i19ct2"> </span></div>'),Ua=M('<div class="preview banner-preview svelte-1i19ct2"><img alt="Banner preview" class="svelte-1i19ct2"/> <span class="svelte-1i19ct2"> </span></div>'),ja=M('<form><!> <div class="form-section svelte-1i19ct2"><h2 class="svelte-1i19ct2"> </h2> <div class="form-group svelte-1i19ct2"><label for="username" class="svelte-1i19ct2"><!> </label> <input id="username" type="text" required class="svelte-1i19ct2"/></div> <div class="form-group svelte-1i19ct2"><label for="email" class="svelte-1i19ct2"><!> </label> <input id="email" type="email" placeholder="your@email.com" required class="svelte-1i19ct2"/></div> <div class="form-group svelte-1i19ct2"><label for="description" class="svelte-1i19ct2"><!> </label> <textarea id="description" rows="4" class="svelte-1i19ct2"></textarea></div></div> <div class="form-section svelte-1i19ct2"><h2 class="svelte-1i19ct2"> </h2> <div class="form-group svelte-1i19ct2"><label for="avatar" class="svelte-1i19ct2"><!> </label> <input id="avatar" type="file" accept="image/*" class="svelte-1i19ct2"/> <!></div> <div class="form-group svelte-1i19ct2"><label for="banner" class="svelte-1i19ct2"><!> </label> <input id="banner" type="file" accept="image/*" class="svelte-1i19ct2"/> <!></div></div> <div class="form-actions svelte-1i19ct2"><a class="btn-secondary svelte-1i19ct2"> </a> <button type="submit" class="btn-primary svelte-1i19ct2"> </button></div></form>'),ka=M('<div class="app svelte-1i19ct2"><!> <!> <main><div class="settings-container svelte-1i19ct2"><h1 class="svelte-1i19ct2"> </h1> <!></div></main></div>');function Ta(S,$){na($,!1);const w=()=>ma(fa,"$language",A),[A,U]=pa(),p=m(),a=m();let v=m(null),O=m(!0),$e=m(!0),x=m(!1),j=m(""),P=m(""),R=m(""),T=m(""),q=m(""),V=m(""),k=m(null),C=m(null);la(async()=>{const o=await fetch("/api/auth/me");if(!o.ok){window.location.href="/login";return}const l=await o.json();i(v,l.user),i(P,e(v).username),i(R,e(v).email),i(T,e(v).description||""),i(q,e(v).avatar||""),i(V,e(v).banner||""),i($e,!1)});async function Ie(o){o.preventDefault(),i(x,!0),i(j,"");const l=new FormData;l.append("username",e(P)),l.append("email",e(R)),l.append("description",e(T)),e(k)&&l.append("avatar",e(k)),e(C)&&l.append("banner",e(C));const y=await fetch("/api/user/update",{method:"PUT",body:l});if(y.ok){i(j,e(p)==="ru"?"Настройки успешно сохранены!":"Settings saved successfully!");const B=await y.json();i(v,B.user),i(q,e(v).avatar),i(V,e(v).banner),i(k,null),i(C,null),setTimeout(()=>i(j,""),3e3)}else{const B=await y.json();i(j,B.error||(e(p)==="ru"?"Не удалось сохранить настройки":"Failed to save settings"))}i(x,!1)}function De(o){const l=o.target;l.files&&l.files[0]&&i(k,l.files[0])}function Oe(o){const l=o.target;l.files&&l.files[0]&&i(C,l.files[0])}Ne(()=>w(),()=>{i(p,w())}),Ne(()=>e(p),()=>{i(a,ga[e(p)])}),va(),ia();var G=ka();_a("1i19ct2",o=>{oa(()=>{da.title="Settings - VibeTube"})});var xe=t(G);ha(xe,{get user(){return e(v)},onMenuClick:()=>i(O,!e(O))});var we=r(xe,2);$a(we,{get isOpen(){return e(O)},get user(){return e(v)}});var J=r(we,2);let ye;var ze=t(J),K=t(ze),Pe=t(K,!0);s(K);var Re=r(K,2);{var Te=o=>{var l=ya(),y=t(l,!0);s(l),z(()=>u(y,(e(a),d(()=>e(a).loading)))),f(o,l)},qe=o=>{var l=ja(),y=t(l);{var B=n=>{var c=za();let g;var h=t(c,!0);s(c),z(_=>{g=Be(c,1,"message svelte-1i19ct2",null,g,_),u(h,e(j))},[()=>({success:e(j).includes("success")})]),f(n,c)};N(y,n=>{e(j)&&n(B)})}var Q=r(y,2),W=t(Q),Ve=t(W,!0);s(W);var X=r(W,2),ee=t(X),Me=t(ee);ba(Me,{size:18});var Ye=r(Me);s(ee);var Y=r(ee,2);Fe(Y),s(X);var ae=r(X,2),te=t(ae),Se=t(te);wa(Se,{size:18});var Ze=r(Se);s(te);var se=r(te,2);Fe(se),s(ae);var Ae=r(ae,2),re=t(Ae),Ue=t(re);xa(Ue,{size:18});var Ee=r(Ue);s(re);var Z=r(re,2);ua(Z),s(Ae),s(Q);var ie=r(Q,2),le=t(ie),Ge=t(le,!0);s(le);var ne=r(le,2),ve=t(ne),je=t(ve);He(je,{size:18});var Je=r(je);s(ve);var ce=r(ve,2),Ke=r(ce,2);{var Qe=n=>{var c=Ma(),g=t(c),h=r(g,2),_=t(h,!0);s(h),s(c),z(b=>{L(g,"src",b),u(_,(e(a),d(()=>e(a).newAvatar)))},[()=>(e(k),d(()=>URL.createObjectURL(e(k))))]),f(n,c)},We=n=>{var c=I(),g=D(c);{var h=_=>{var b=Sa(),F=t(b),H=r(F,2),pe=t(H,!0);s(H),s(b),z(()=>{L(F,"src",e(q)),u(pe,(e(a),d(()=>e(a).currentAvatar)))}),f(_,b)};N(g,_=>{e(q)&&_(h)},!0)}f(n,c)};N(Ke,n=>{e(k)?n(Qe):n(We,!1)})}s(ne);var ke=r(ne,2),oe=t(ke),Ce=t(oe);He(Ce,{size:18});var Xe=r(Ce);s(oe);var de=r(oe,2),ea=r(de,2);{var aa=n=>{var c=Aa(),g=t(c),h=r(g,2),_=t(h,!0);s(h),s(c),z(b=>{L(g,"src",b),u(_,(e(a),d(()=>e(a).newBanner)))},[()=>(e(C),d(()=>URL.createObjectURL(e(C))))]),f(n,c)},ta=n=>{var c=I(),g=D(c);{var h=_=>{var b=Ua(),F=t(b),H=r(F,2),pe=t(H,!0);s(H),s(b),z(()=>{L(F,"src",e(V)),u(pe,(e(a),d(()=>e(a).currentBanner)))}),f(_,b)};N(g,_=>{e(V)&&_(h)},!0)}f(n,c)};N(ea,n=>{e(C)?n(aa):n(ta,!1)})}s(ke),s(ie);var Le=r(ie,2),E=t(Le),sa=t(E,!0);s(E);var ue=r(E,2),ra=t(ue,!0);s(ue),s(Le),s(l),z(()=>{u(Ve,(e(a),d(()=>e(a).profileSettings))),u(Ye,` ${e(a),d(()=>e(a).username)??""}`),L(Y,"placeholder",e(p)==="ru"?"Ваше имя пользователя":"Your username"),Y.disabled=e(x),u(Ze,` ${e(a),d(()=>e(a).email)??""}`),se.disabled=e(x),u(Ee,` ${e(p)==="ru"?"Описание канала":"Channel Description"}`),L(Z,"placeholder",e(p)==="ru"?"Расскажите зрителям о вашем канале...":"Tell viewers about your channel..."),Z.disabled=e(x),u(Ge,(e(a),d(()=>e(a).channelAppearance))),u(Je,` ${e(a),d(()=>e(a).avatarImage)??""}`),ce.disabled=e(x),u(Xe,` ${e(a),d(()=>e(a).bannerImage)??""}`),de.disabled=e(x),L(E,"href",`/channel/${e(v),d(()=>e(v).id)??""}`),u(sa,(e(a),d(()=>e(a).cancel))),ue.disabled=e(x),u(ra,(e(x),e(p),e(a),d(()=>e(x)?e(p)==="ru"?"Сохранение...":"Saving...":e(a).saveChanges)))}),_e(Y,()=>e(P),n=>i(P,n)),_e(se,()=>e(R),n=>i(R,n)),_e(Z,()=>e(T),n=>i(T,n)),me("change",ce,De),me("change",de,Oe),me("submit",l,Ie),f(o,l)};N(Re,o=>{e($e)?o(Te):o(qe,!1)})}s(ze),s(J),s(G),z(()=>{ye=Be(J,1,"svelte-1i19ct2",null,ye,{"sidebar-open":e(O)}),u(Pe,e(p)==="ru"?"Настройки канала":"Channel Settings")}),f(S,G),ca(),U()}export{Ta as component};
