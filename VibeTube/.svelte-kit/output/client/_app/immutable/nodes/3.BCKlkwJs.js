import{f as y,a as _,c as ea}from"../chunks/b5zj641C.js";import{i as Va}from"../chunks/CPnGWO-2.js";import{o as Da}from"../chunks/Bvetg77p.js";import{p as Oa,l as A,j as Ra,t as b,k as Ta,o as a,n as h,m as u,q as r,r as d,v as s,$ as Ha,u as i,f as B,x as Ma}from"../chunks/BM2AIrRx.js";import{s as p,e as Na}from"../chunks/D17zy_22.js";import{i as C,a as qa,b as sa}from"../chunks/BLbrYCs1.js";import{h as Fa}from"../chunks/DMkD6tIR.js";import{l as Ga,t as Ja,s as ta,a as Pa,b as ra}from"../chunks/C02I7yOd.js";import{p as za}from"../chunks/Dt7nbsjP.js";import{H as Aa}from"../chunks/aIAfHqPP.js";import{S as Ba}from"../chunks/BcVKEG13.js";import{f as ia,V as Ea}from"../chunks/DQflonDh.js";var Ka=y('<div class="loading svelte-1v8wu38"> </div>'),La=y('<p class="description svelte-1v8wu38"> </p>'),Qa=y('<div class="my-channel-badge svelte-1v8wu38"><span class="svelte-1v8wu38"> </span> <a href="/settings" class="btn-secondary"> </a> <a href="/studio" class="btn-primary"> </a></div>'),Ua=y("<button> </button>"),Wa=y('<div class="empty svelte-1v8wu38"> </div>'),Xa=y('<div class="channel-header svelte-1v8wu38"><div class="banner svelte-1v8wu38"></div> <div class="channel-info svelte-1v8wu38"><img class="avatar svelte-1v8wu38"/> <div class="info svelte-1v8wu38"><h1 class="svelte-1v8wu38"> </h1> <p class="stats svelte-1v8wu38"> </p> <!></div> <!></div></div> <div class="container"><h2 class="svelte-1v8wu38"> </h2> <!></div>',1),Ya=y('<div class="error svelte-1v8wu38"> </div>'),Za=y('<div class="app svelte-1v8wu38"><!> <!> <main><!></main></div>');function de(na,oa){Oa(oa,!1);const E=()=>sa(Ga,"$language",L),K=()=>sa(za,"$page",L),[L,va]=qa(),R=h(),e=h(),g=h();let t=h(null),x=h([]),w=h(null),O=h(!0),I=h(!1),T=h(!0);Da(async()=>{await la()});async function la(){u(T,!0);try{const v=await fetch("/api/auth/me");if(v.ok){const l=await v.json();u(w,l.user)}}catch{}const o=await fetch(`/api/users/${a(g)}`);if(o.ok){const l=(await o.json()).user;l&&u(t,{id:l.id,username:l.username,avatar:l.avatar,banner:l.banner,description:l.description||"",subscribers:0})}const c=await fetch(`/api/videos?userId=${a(g)}`);if(c.ok){const v=await c.json();u(x,v.videos||[])}if(a(w)&&a(t)){const v=await fetch(`/api/subscriptions?channelId=${a(g)}`);if(v.ok){const l=await v.json();u(I,l.subscribed)}}u(T,!1)}async function ca(){if(!a(w)){window.location.href="/login";return}const o=await fetch("/api/subscriptions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({channelId:a(g)})});if(o.ok){const c=await o.json();u(I,c.subscribed)}}A(()=>E(),()=>{u(R,E())}),A(()=>a(R),()=>{u(e,Ja[a(R)])}),A(()=>K(),()=>{u(g,K().params.id)}),Ra(),Va();var H=Za();Fa("1v8wu38",o=>{b(()=>{Ha.title=`${a(t),s(()=>a(t)?.username||"Channel")??""} - VibeTube`},void 0,void 0,void 0,!0)});var Q=r(H);Aa(Q,{get user(){return a(w)},onMenuClick:()=>u(O,!a(O))});var U=d(Q,2);Ba(U,{get isOpen(){return a(O)},get user(){return a(w)}});var M=d(U,2);let W;var ua=r(M);{var da=o=>{var c=Ka(),v=r(c,!0);i(c),b(()=>p(v,(a(e),s(()=>a(e).loading)))),_(o,c)},pa=o=>{var c=ea(),v=B(c);{var l=$=>{var k=Xa(),V=B(k),X=r(V),Y=d(X,2),N=r(Y),q=d(N,2),F=r(q),_a=r(F,!0);i(F);var G=d(F,2),ma=r(G);i(G);var ba=d(G,2);{var ha=n=>{var f=La(),D=r(f,!0);i(f),b(()=>p(D,(a(t),s(()=>a(t).description)))),_(n,f)};C(ba,n=>{a(t),s(()=>a(t).description)&&n(ha)})}i(q);var ga=d(q,2);{var wa=n=>{var f=ea(),D=B(f);{var ja=j=>{var m=Qa(),S=r(m),P=r(S,!0);i(S);var z=d(S,2),Ca=r(z,!0);i(z);var aa=d(z,2),Ia=r(aa,!0);i(aa),i(m),b(()=>{p(P,(a(e),s(()=>a(e).myChannel))),p(Ca,(a(e),s(()=>a(e).settings))),p(Ia,(a(e),s(()=>a(e).studio)))}),_(j,m)},Sa=j=>{var m=Ua();let S;var P=r(m,!0);i(m),b(()=>{S=ta(m,1,"btn-primary svelte-1v8wu38",null,S,{subscribed:a(I)}),p(P,(a(I),a(e),s(()=>a(I)?a(e).subscribed:a(e).subscribe)))}),Na("click",m,ca),_(j,m)};C(D,j=>{a(w),a(g),s(()=>a(w).id===parseInt(a(g)))?j(ja):j(Sa,!1)})}_(n,f)};C(ga,n=>{a(w)&&a(g)&&n(wa)})}i(Y),i(V);var Z=d(V,2),J=r(Z),ya=r(J,!0);i(J);var xa=d(J,2);{var $a=n=>{var f=Wa(),D=r(f,!0);i(f),b(()=>p(D,(a(e),s(()=>a(e).noVideos)))),_(n,f)},ka=n=>{Ea(n,{get videos(){return a(x)}})};C(xa,n=>{a(x),s(()=>a(x).length===0)?n($a):n(ka,!1)})}i(Z),b(n=>{Pa(X,(a(t),s(()=>a(t).banner?`background-image: url(${a(t).banner})`:""))),ra(N,"src",(a(t),s(()=>a(t).avatar))),ra(N,"alt",(a(t),s(()=>a(t).username))),p(_a,(a(t),s(()=>a(t).username))),p(ma,`${n??""} ${a(e),s(()=>a(e).subscribers_other)??""} â€¢ ${a(x),s(()=>a(x).length)??""} ${a(e),s(()=>a(e).videos_other)??""}`),p(ya,(a(e),s(()=>a(e).videos)))},[()=>(Ma(ia),a(t),s(()=>ia(a(t).subscribers)))]),_($,k)},fa=$=>{var k=Ya(),V=r(k,!0);i(k),b(()=>p(V,(a(e),s(()=>a(e).channelNotFound)))),_($,k)};C(v,$=>{a(t)?$(l):$(fa,!1)},!0)}_(o,c)};C(ua,o=>{a(T)?o(da):o(pa,!1)})}i(M),i(H),b(()=>W=ta(M,1,"svelte-1v8wu38",null,W,{"sidebar-open":a(O)})),_(na,H),Ta(),va()}export{de as component};
