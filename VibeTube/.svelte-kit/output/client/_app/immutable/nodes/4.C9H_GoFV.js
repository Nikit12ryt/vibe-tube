import{f as H,a as m,c as I}from"../chunks/b5zj641C.js";import{i as J}from"../chunks/CPnGWO-2.js";import{o as K}from"../chunks/Bvetg77p.js";import{p as L,l as q,j as N,t as w,k as P,o as e,n as i,y as Q,m as n,q as l,r as k,$ as U,u as f,v as d,f as X}from"../chunks/BM2AIrRx.js";import{s as $}from"../chunks/D17zy_22.js";import{i as C,a as Y,b as Z}from"../chunks/BLbrYCs1.js";import{h as ee}from"../chunks/DMkD6tIR.js";import{l as te,t as ae,s as se}from"../chunks/C02I7yOd.js";import{H as re}from"../chunks/aIAfHqPP.js";import{S as oe}from"../chunks/BcVKEG13.js";import{V as ie}from"../chunks/DQflonDh.js";var ne=H('<div class="loading svelte-1xl2tfr"> </div>'),le=H('<div class="empty svelte-1xl2tfr"> </div>'),fe=H('<div class="app svelte-1xl2tfr"><!> <!> <main><div class="container"><h1 class="svelte-1xl2tfr"> </h1> <!></div></main></div>');function ye(D,G){L(G,!1);const j=()=>Z(te,"$language",R),[R,T]=Y(),p=i(),r=i();let c=i([]),_=i(null),v=i(!0),S=i(!0);K(async()=>{const t=await fetch("/api/auth/me");if(!t.ok){window.location.href="/login";return}const s=await t.json();n(_,s.user);const o=await fetch("/api/watch-history");if(o.ok){const b=await o.json(),u=new Set;n(c,b.videos.filter(a=>u.has(a.id)?!1:(u.add(a.id),!0)))}n(S,!1)}),q(()=>j(),()=>{n(p,j())}),q(()=>e(p),()=>{n(r,ae[e(p)])}),N(),J();var g=fe();ee("1xl2tfr",t=>{Q(()=>{U.title="Watch History - VibeTube"})});var V=l(g);re(V,{get user(){return e(_)},onMenuClick:()=>n(v,!e(v))});var M=k(V,2);oe(M,{get isOpen(){return e(v)},get user(){return e(_)}});var h=k(M,2);let O;var W=l(h),x=l(W),z=l(x,!0);f(x);var A=k(x,2);{var B=t=>{var s=ne(),o=l(s,!0);f(s),w(()=>$(o,(e(r),d(()=>e(r).loading)))),m(t,s)},E=t=>{var s=I(),o=X(s);{var b=a=>{var y=le(),F=l(y,!0);f(y),w(()=>$(F,(e(r),d(()=>e(r).noWatchHistory)))),m(a,y)},u=a=>{ie(a,{get videos(){return e(c)}})};C(o,a=>{e(c),d(()=>e(c).length===0)?a(b):a(u,!1)},!0)}m(t,s)};C(A,t=>{e(S)?t(B):t(E,!1)})}f(W),f(h),f(g),w(()=>{O=se(h,1,"svelte-1xl2tfr",null,O,{"sidebar-open":e(v)}),$(z,(e(r),d(()=>e(r).history)))}),m(D,g),P(),T()}export{ye as component};
